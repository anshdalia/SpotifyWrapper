<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your {{ duo_wrap.year }} Duo Wrapped</title>
    {% load static %}
    {% load wrap_filters %}
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <link href="{% static 'custom/duo_wrap.css' %}" rel="stylesheet">
</head>
<body>
    <div class="carousel-container">
        <!-- Welcome Slide -->
        <div class="carousel-slide welcome-slide active">
            <div class="slide-content">
                <div class="title animate__animated animate__fadeInUp">Your {{ duo_wrap.year }} Duo Wrapped</div>
                <div class="subtitle animate__animated animate__fadeInUp">See how you and your friend compare</div>
                <div class="highlight animate__animated animate__zoomIn">Ready?</div>
            </div>
        </div>

        <!-- Top Artists Comparison Slide -->
        <div class="carousel-slide artists-slide">
            <div class="slide-content">
                <div class="title">Top Artists</div>
                <div class="comparison-container">
                    <div class="comparison-item">
                        <h3>{{ duo_wrap.user1.username }}</h3>
                        <ul class="top-list">
                            {% for artist in duo_wrap.user1_top_artists %}
                            <li class="top-item animate__animated animate__fadeInLeft" {% if forloop.counter0 > 0 %}style="animation-delay: {{ forloop.counter0|multiply:0.2 }}s;"{% endif %}>
                                <span class="item-rank">{{ artist.rank }}</span>
                                <img class="item-image" src="{{ artist.image_url|default:'/api/placeholder/60/60' }}" alt="{{ artist.name }}">
                                <div class="item-details">
                                    <p class="item-name">{{ artist.name }}</p>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <h3>{{ duo_wrap.user2.username }}</h3>
                        <ul class="top-list">
                            {% for artist in duo_wrap.user2_top_artists %}
                            <li class="top-item animate__animated animate__fadeInRight" {% if forloop.counter0 > 0 %}style="animation-delay: {{ forloop.counter0|multiply:0.2 }}s;"{% endif %}>
                                <span class="item-rank">{{ artist.rank }}</span>
                                <img class="item-image" src="{{ artist.image_url|default:'/api/placeholder/60/60' }}" alt="{{ artist.name }}">
                                <div class="item-details">
                                    <p class="item-name">{{ artist.name }}</p>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Top Songs Comparison Slide -->
        <div class="carousel-slide songs-slide">
            <div class="slide-content">
                <div class="title">Top Songs</div>
                <div class="comparison-container">
                    <div class="comparison-item">
                        <h3>{{ duo_wrap.user1.username }}</h3>
                        <ul class="top-list">
                            {% for song in duo_wrap.user1_top_songs %}
                            <li class="top-item animate__animated animate__fadeInLeft" {% if forloop.counter0 > 0 %}style="animation-delay: {{ forloop.counter0|multiply:0.2 }}s;"{% endif %}>
                                <span class="item-rank">{{ song.rank }}</span>
                                <img class="item-image" src="{{ song.image_url|default:'/api/placeholder/60/60' }}" alt="{{ song.title }}">
                                <div class="item-details">
                                    <p class="item-name">{{ song.title }}</p>
                                    <small>{{ song.artist }}</small>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="comparison-item">
                        <h3>{{ duo_wrap.user2.username }}</h3>
                        <ul class="top-list">
                            {% for song in duo_wrap.user2_top_songs %}
                            <li class="top-item animate__animated animate__fadeInRight" {% if forloop.counter0 > 0 %}style="animation-delay: {{ forloop.counter0|multiply:0.2 }}s;"{% endif %}>
                                <span class="item-rank">{{ song.rank }}</span>
                                <img class="item-image" src="{{ song.image_url|default:'/api/placeholder/60/60' }}" alt="{{ song.title }}">
                                <div class="item-details">
                                    <p class="item-name">{{ song.title }}</p>
                                    <small>{{ song.artist }}</small>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Top Genre Comparison Slide -->
        <div class="carousel-slide genre-slide">
            <div class="slide-content">
                <div class="title">Top Genre</div>
                <div class="comparison-container">
                    <div class="comparison-item">
                        <img class="genre-image animate__animated animate__zoomIn" src="/api/placeholder/200/200" alt="{{ duo_wrap.user1_top_genre }}">
                        <div class="highlight animate__animated animate__fadeInUp">{{ duo_wrap.user1_top_genre }}</div>
                    </div>
                    <div class="comparison-item">
                        <img class="genre-image animate__animated animate__zoomIn" src="/api/placeholder/200/200" alt="{{ duo_wrap.user2_top_genre }}">
                        <div class="highlight animate__animated animate__fadeInUp">{{ duo_wrap.user2_top_genre }}</div>
                    </div>
                </div>
                <div class="subtitle animate__animated animate__fadeInUp">Compare your musical tastes!</div>
            </div>
        </div>

        <!-- Minutes Listened Comparison Slide -->
        <div class="carousel-slide minutes-slide">
            <div class="slide-content">
                <div class="title">Minutes Listened</div>
                <div class="comparison-container">
                    <div class="comparison-item">
                        <div class="highlight animate__animated animate__zoomIn">{{ duo_wrap.user1_minutes_listened }}</div>
                        <div class="subtitle">{{ duo_wrap.user1.username }}</div>
                    </div>
                    <div class="comparison-item">
                        <div class="highlight animate__animated animate__zoomIn">{{ duo_wrap.user2_minutes_listened }}</div>
                        <div class="subtitle">{{ duo_wrap.user2.username }}</div>
                    </div>
                </div>
                <div class="subtitle animate__animated animate__fadeInUp">See how your listening compares!</div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation-container">
            <div class="nav-buttons">
                <button class="nav-button" onclick="previousSlide()">Previous</button>
                <button class="nav-button" onclick="nextSlide()">Next</button>
            </div>
            <button class="menu-button" onclick="window.location.href='{% url 'main_menu' %}'">Back to Menu</button>
        </div>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.carousel-slide');

        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));

            currentSlide = index;
            if (currentSlide >= slides.length) currentSlide = 0;
            if (currentSlide < 0) currentSlide = slides.length - 1;

            slides[currentSlide].classList.add('active');
        }

        function nextSlide() {
            showSlide(currentSlide + 1);
        }

        function previousSlide() {
            showSlide(currentSlide - 1);
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextSlide();
            if (e.key === 'ArrowLeft') previousSlide();
        });
    </script>
</body>
</html>